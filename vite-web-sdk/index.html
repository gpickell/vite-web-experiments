<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="data:image/x-icon;base64,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" />
    <title>Vite + React + Web Viewer</title>
  </head>
  <body role="application">
    <div id="gcx-app"></div>
    <script type="module">
        function getAbsoluteUrl(value) {
            const url = new URL(value, location.href);
            return url.toString();
        }

        async function getAppConfig() {
            const res = await fetch(getAbsoluteUrl("app.json"));
            return await res.json();
        }

        async function hoistViewer() {
            const res = await fetch("viewer/index.html");
            const parser = new DOMParser();
            const html = parser.parseFromString(await res.text(), "text/html");
            for (const node of [...html.head.children]) {
                if (node.tagName === "SCRIPT") {
                    const script = document.createElement("script");
                    const src = node.getAttribute("src");
                    src && script.setAttribute("src", src);
                    script.innerHTML = node.innerHTML;
                    document.head.append(script);

                    if (src) {
                        await new Promise(x => script.addEventListener("load", x));
                    }
                }

                if (node.tagName === "STYLE") {
                    document.head.append(document.adoptNode(node));
                }
            }

            window.__import = (name) => {
                return new Promise((resolve, reject) => {
                    const hoist = value => {
                        if (!value.__esModule) {
                            const result = Object.create(value);
                            result.__esModule = true;

                            if (!("default" in value)) {
                                result.default = value;
                            }
                            
                            value = result;
                        }

                        resolve(value);
                    };

                    require([name], hoist, reject);
                });        
            };

            const appConfig = await getAppConfig();
            const startup = await Promise.all([
                import("web"),
                import("@vertigis/web-libraries!/common"),
                import("@vertigis/web-libraries!/web"),
            ]);

            const webViewer = startup.shift();
            startup.push(await import("/src/index.ts"));

            webViewer.bootstrap({
                appConfig,
                layout: getAbsoluteUrl("layout.xml"),
                libraries: startup.map(lib => lib.default),
            });
        }

        hoistViewer();        
    </script>
  </body>
</html>
